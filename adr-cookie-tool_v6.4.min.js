/*! Cookie Consent Script - v6.5 Author: Andy Dominique Rak Instagram: https://instagram.com/andydominiquerak */
(function(){function tryInit(){var banner=document.querySelector('[adr-cookie="banner"]'),cookieNameAttr=banner&&banner.getAttribute("data-adr-cookie-name")||"AdrTastyCookie",COOKIE_PREFIX=cookieNameAttr+"_",COOKIE_NAME=COOKIE_PREFIX+"consent",COOKIE_PERFORMANCE=COOKIE_PREFIX+"performance",COOKIE_PERSONALIZATION=COOKIE_PREFIX+"personalization",COOKIE_ADVERTISEMENT=COOKIE_PREFIX+"advertisement",allowButton=document.querySelector('[adr-cookie="allow"]'),denyButton=document.querySelector('[adr-cookie="deny"]'),prefsButton=document.querySelector('[adr-cookie="prefs"]'),modalBg=document.querySelector('[adr-cookie="modal-bg"]'),modal=document.querySelector('[adr-cookie="modal"]'),modalCloseButton=document.querySelector('[adr-cookie="modal-close"]'),saveButton=document.querySelector('[adr-cookie="save"]'),editButton=document.querySelector('[adr-cookie="edit"]'),perfToggle=document.querySelector('[adr-cookie="perf"]'),perfSwitch=document.querySelector('[adr-cookie="perf-switch"]'),persToggle=document.querySelector('[adr-cookie="pers"]'),persSwitch=document.querySelector('[adr-cookie="pers-switch"]'),adToggle=document.querySelector('[adr-cookie="ad"]'),adSwitch=document.querySelector('[adr-cookie="ad-switch"]'),switchStates={perf:!1,pers:!1,ad:!1};
if(!banner||!allowButton||!denyButton||!prefsButton||!modalBg||!modal||!modalCloseButton||!saveButton){setTimeout(tryInit,50);return;}
// --- Animation Settings ---
var motion=banner.getAttribute("data-adr-cookie-motion")||"slide",motionDuration=parseInt(banner.getAttribute("data-adr-cookie-speed"))||500,mainColor=banner.getAttribute("data-adr-cookie-color")||"#f5f500";
var slideInAnimation=function(){
  if(motion==="fade"){gsap.fromTo(banner,{opacity:0},{opacity:1,duration:motionDuration/1000,ease:"power2.out"});}
  else if(motion==="bounce"){gsap.fromTo(banner,{y:"100%",opacity:0},{y:"0%",opacity:1,duration:motionDuration/1000,ease:"bounce.out"});}
  else{gsap.fromTo(banner,{y:"100%",opacity:0},{y:"0%",opacity:1,duration:motionDuration/1000,ease:"power2.out"});}
};
var slideOutAnimation=function(cb){
  if(motion==="fade"){gsap.to(banner,{opacity:0,duration:motionDuration/1000,ease:"power2.in",onComplete:cb});}
  else if(motion==="bounce"){gsap.to(banner,{y:"100%",opacity:0,duration:motionDuration/1000,ease:"bounce.in",onComplete:cb});}
  else{gsap.to(banner,{y:"100%",opacity:0,duration:motionDuration/1000,ease:"power2.in",onComplete:cb});}
};
var showModal=function(){gsap.set(modalBg,{display:"flex",opacity:0}),gsap.set(modal,{display:"flex",opacity:0,y:100}),gsap.to(modalBg,{opacity:1,duration:.5,ease:"power2.out"}),gsap.to(modal,{y:0,opacity:1,duration:.5,ease:"power2.out"})};
var hideModal=function(cb){gsap.to(modal,{y:100,opacity:0,duration:.5,ease:"power2.in",onComplete:function(){gsap.set(modal,{display:"none"}),cb&&cb()}}),gsap.to(modalBg,{opacity:0,duration:.5,ease:"power2.in",onComplete:function(){gsap.set(modalBg,{display:"none"})}})};
// --- Cookie Logic ---
var setCookie=function(n,v,d){var ex=new Date(Date.now()+864e5*d).toUTCString();document.cookie=n+"="+v+"; expires="+ex+"; path=/";};
var getCookie=function(n){var c=document.cookie.split("; ").find(function(row){return row.startsWith(n+"=")});return c?c.split("=")[1]:null;};
var saveSwitchStatesToCookies=function(){var perf=switchStates.perf?"Allowed":"Denied",pers=switchStates.pers?"Allowed":"Denied",ad=switchStates.ad?"Allowed":"Denied";setCookie(COOKIE_PERFORMANCE,perf,365),setCookie(COOKIE_PERSONALIZATION,pers,365),setCookie(COOKIE_ADVERTISEMENT,ad,365),setCookie(COOKIE_NAME,switchStates.perf||switchStates.pers||switchStates.ad?"Allowed":"Denied",365);runDeferredScripts();return switchStates.perf||switchStates.pers||switchStates.ad;};
// --- Switch Anim ---
var toggleSwitch=function(el,key){if(!el)return;var on=switchStates[key],pos=on?"0%":"100%",color=on?"#ccc":mainColor;gsap.to(el,{x:pos,backgroundColor:color,duration:.3,ease:"power2.out"}),switchStates[key]=!on;};
// --- Script Loader ---
function runDeferredScripts(){
  // performance
  if(getCookie(COOKIE_PERFORMANCE)==="Allowed"){
    document.querySelectorAll('script[adr-cc="performance"][type="text/plain"]').forEach(function(tag){
      var s=document.createElement("script");
      tag.innerText?s.text=tag.innerText:s.text=tag.textContent;
      Array.prototype.forEach.call(tag.attributes,function(a){if(a.name!=="type"){s.setAttribute(a.name,a.value)}});
      s.type="text/javascript";tag.parentNode.replaceChild(s,tag);
    });
  }
  // personalization
  if(getCookie(COOKIE_PERSONALIZATION)==="Allowed"){
    document.querySelectorAll('script[adr-cc="personalization"][type="text/plain"]').forEach(function(tag){
      var s=document.createElement("script");
      tag.innerText?s.text=tag.innerText:s.text=tag.textContent;
      Array.prototype.forEach.call(tag.attributes,function(a){if(a.name!=="type"){s.setAttribute(a.name,a.value)}});
      s.type="text/javascript";tag.parentNode.replaceChild(s,tag);
    });
  }
  // advertisement
  if(getCookie(COOKIE_ADVERTISEMENT)==="Allowed"){
    document.querySelectorAll('script[adr-cc="advertisement"][type="text/plain"]').forEach(function(tag){
      var s=document.createElement("script");
      tag.innerText?s.text=tag.innerText:s.text=tag.textContent;
      Array.prototype.forEach.call(tag.attributes,function(a){if(a.name!=="type"){s.setAttribute(a.name,a.value)}});
      s.type="text/javascript";tag.parentNode.replaceChild(s,tag);
    });
  }
}
// --- Banner Loader ---
var initBanner=function(){var e=getCookie(COOKIE_NAME);"Allowed"===e?(gsap.set(banner,{display:"none"}),runDeferredScripts()):(gsap.set(banner,{display:"flex"}),slideInAnimation());};
allowButton.addEventListener("click",function(){setCookie(COOKIE_NAME,"Allowed",365),setCookie(COOKIE_PERFORMANCE,"Allowed",365),setCookie(COOKIE_PERSONALIZATION,"Allowed",365),setCookie(COOKIE_ADVERTISEMENT,"Allowed",365),slideOutAnimation(function(){gsap.set(banner,{display:"none"}),runDeferredScripts()})});
denyButton.addEventListener("click",function(){setCookie(COOKIE_NAME,"Denied",365),setCookie(COOKIE_PERFORMANCE,"Denied",365),setCookie(COOKIE_PERSONALIZATION,"Denied",365),setCookie(COOKIE_ADVERTISEMENT,"Denied",365),slideOutAnimation(function(){gsap.set(banner,{display:"none"})})});
prefsButton.addEventListener("click",function(){slideOutAnimation(function(){gsap.set(banner,{display:"none"}),showModal()})});
modalCloseButton.addEventListener("click",function(){hideModal(function(){gsap.set(banner,{display:"flex"}),slideInAnimation()})});
saveButton.addEventListener("click",function(){var e=saveSwitchStatesToCookies();hideModal(function(){e||gsap.set(banner,{display:"flex"})})});
editButton&&editButton.addEventListener("click",function(){showModal()});
perfToggle&&perfToggle.addEventListener("click",function(){toggleSwitch(perfSwitch,"perf")});
persToggle&&persToggle.addEventListener("click",function(){toggleSwitch(persSwitch,"pers")});
adToggle&&adToggle.addEventListener("click",function(){toggleSwitch(adSwitch,"ad")});
initBanner();
}
if(document.readyState==="complete"||document.readyState==="interactive"){tryInit();}else{document.addEventListener("DOMContentLoaded",tryInit);}
})();
